# Solution 1
select user_id from(
select user_id,
sum(case when type = 'Refinance' then 1 else 0 end) cnt_refinance,
sum(case when type = 'InSchool' then 1 else 0 end) cnt_inschool
from loans
group by 1)x
where cnt_refinance>=1 and cnt_inschool>=1

# Solution 2 
SELECT user_id
FROM submissions
WHERE submission_type IN ('Refinance', 'InSchool')
GROUP BY user_id
HAVING COUNT(DISTINCT CASE WHEN submission_type = 'Refinance' THEN submission_type END) > 0
   AND COUNT(DISTINCT CASE WHEN submission_type = 'InSchool' THEN submission_type END) > 0;

# Pandas 
import pandas as pd
type_counts = loans.groupby('user_id')['type'].value_counts().unstack(fill_value=0).reset_index()
filtered_users = type_counts[(type_counts['Refinance'] >= 1) & (type_counts['InSchool'] >= 1)]['user_id']
result_df = pd.DataFrame(filtered_users)
result_df
